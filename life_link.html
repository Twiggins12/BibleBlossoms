<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bible Blossoms | Life Link</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<link rel="icon" type="image/png" href="favicon.png">
<link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">

<link rel="stylesheet" href="css/styles.css">
<link rel="stylesheet" href="css/life_link.css">

</head>

<body>

<header id="top">
<h1>Life Link</h1>
<h2>Bible Topical Reference</h2>
</header>

<div id="domain-top-left">
<a href="index.html">BibleBlossoms</a>
</div>


<div class="content">

<h3>A Work in Progress - Growing Daily</h3>

<p>
This reference tool is just beginning its journey.
I’m building it prayerfully and carefully, adding new topics and Scripture references nearly every day.
It may feel incomplete at times — and that’s because it is still growing.
My desire is that, over the years, Life Link will become a rich and trusted Bible topical reference to support deeper study and understanding.
Thank you for your patience as this work unfolds.
</p>

<p>Began February 4, 2026</p>
<p>Last Updated February 26, 2026</p>

<div class="section-container">
<div class="section-heading">Select Bible Version</div>

<div class="dropdown-column">
<select id="versionSelect">
<option value="WEB">World English Bible</option>
<option value="KJV">King James Version</option>
</select>
</div>
</div>

</div>


<div class="page-content">

<div id="sections-container">

<div class="section-container">
<div class="section-heading">Father, Son, Holy Spirit</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Creation, Earth, Animals</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">History, Laws, Sin</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">People, Culture, Objects</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Mind, Body, Spirit</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Places, Travels</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Spiritual Beings, Miracles</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Visions, Prophecies, End Times</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Wisdom, Instructions</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Promises, Covenants</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

<div class="section-container">
<div class="section-heading">Concepts, Ideas, Principles</div>
<div class="dropdown-column">
<select class="mainTopicSelect"><option value="">Select Main Topic</option></select>
<select class="subTopicSelect"><option value="">Select Sub-Topic</option></select>
<select class="bookSelect"><option value="">Select Book</option></select>
<div class="verseText"></div>
</div>
</div>

</div>


<section class="copyright">

<h3>Copyright & Attribution</h3>

<p>
All Scripture quotations are in the public domain and may be freely quoted, copied, and shared.
</p>
<p>
Life Link is an independent project and is not affiliated with
the World English Bible organization.
</p>

</section>

</div>


<script>
let bible = [];

const versionSelect = document.getElementById("versionSelect");
const sections = document.querySelectorAll("#sections-container .section-container");

const csvFiles = [
  "data/sections/section1_Father.csv",
  "data/sections/section2_Creation.csv",
  "data/sections/section3_History.csv",
  "data/sections/section4_People.csv",
  "data/sections/section5_Mind.csv",
  "data/sections/section6_Places.csv",
  "data/sections/section7_Spiritual_Beings.csv",
  "data/sections/section8_Visions.csv",
  "data/sections/section9_Wisdom.csv",
  "data/sections/section10_Promises.csv",
  "data/sections/section11_Concepts.csv"
];

// Load Bible JSON
async function loadBible(version) {
  try {
    const res = await fetch(`https://raw.githubusercontent.com/Twiggins12/BibleBlossoms/main/bibles/${version}.json`);
    const data = await res.json();

    if (version === "KJV") {
      bible = convertKJVAbbrevToWebLike(data);
      console.log("KJV book names:", bible.map(b => b.name));
    } else {
      bible = data.books; // WEB
    }

    console.log("Bible loaded:", version, "books:", bible?.length);
  } catch (err) {
    console.error("Failed to load Bible:", err);
  }
}

 function convertKJVAbbrevToWebLike(kjvBooks) {
  const abbrevToName = {
    gn: "Genesis",
    ex: "Exodus",
    lv: "Leviticus",
    nu: "Numbers",
    nm: "Numbers",
    nb: "Numbers",
    num: "Numbers",
    dt: "Deuteronomy",
    js: "Joshua",
    jg: "Judges",
    rt: "Ruth",
    "1sm": "1 Samuel",
    "2sm": "2 Samuel",
    "1kg": "1 Kings",
    "2kg": "2 Kings",
    "1ch": "1 Chronicles",
    "2ch": "2 Chronicles",
    ezr: "Ezra",
    ne: "Nehemiah",
    es: "Esther",
    jb: "Job",
    ps: "Psalms",
    pr: "Proverbs",
    ec: "Ecclesiastes",
    so: "Song of Solomon",
    is: "Isaiah",
    jr: "Jeremiah",
    lm: "Lamentations",
    ez: "Ezekiel",
    dn: "Daniel",
    ho: "Hosea",
    jl: "Joel",
    am: "Amos",
    ob: "Obadiah",
    jn: "Jonah",
    mi: "Micah",
    na: "Nahum",
    hk: "Habakkuk",
    zp: "Zephaniah",
    hg: "Haggai",
    zc: "Zechariah",
    ml: "Malachi",
    mt: "Matthew",
    mk: "Mark",
    lk: "Luke",
    jo: "John",
    ac: "Acts",
    ro: "Romans",
    "1co": "1 Corinthians",
    "2co": "2 Corinthians",
    ga: "Galatians",
    ep: "Ephesians",
    ph: "Philippians",
    cl: "Colossians",
    "1ts": "1 Thessalonians",
    "2ts": "2 Thessalonians",
    "1tm": "1 Timothy",
    "2tm": "2 Timothy",
    tt: "Titus",
    pm: "Philemon",
    hb: "Hebrews",
    he: "Hebrews",
    heb: "Hebrews",
    jm: "James",
    "1pe": "1 Peter",
    "2pe": "2 Peter",
    "1jo": "1 John",
    "2jo": "2 John",
    "3jo": "3 John",
    jd: "Jude",
    re: "Revelation",
    // Aliases found in your KJV.json
jud: "Judges",
"1kgs": "1 Kings",
"2kgs": "2 Kings",
et: "Esther",
job: "Job",
prv: "Proverbs",
act: "Acts",
rm: "Romans",
gl: "Galatians",
eph: "Ephesians",
phm: "Philemon"
  };

  return kjvBooks.map((book, bookIndex) => {
    const ab = (book.abbrev || "").toLowerCase().trim();

    if (!abbrevToName[ab]) {
      console.warn("Unknown KJV abbrev:", ab, "at index", bookIndex);
    }

    const fullName = abbrevToName[ab] || book.abbrev || `Book ${bookIndex + 1}`;

    return {
      name: fullName,
      commonName: fullName,
      chapters: (book.chapters || []).map((chapterArr, chapIndex) => ({
        number: chapIndex + 1,
        content: (chapterArr || []).map((verseText, verseIndex) => ({
          number: verseIndex + 1,
          content: [String(verseText ?? "")]
        }))
      }))
    };
  });
}
// Get verse text
function normalizeBookName(name) {
  const n = (name ?? "").toString().trim();

  const map = {
    "Psalm": "Psalms",
    "Psalms": "Psalms",
    "Song of Songs": "Song of Solomon",
    "Song of Solomon": "Song of Solomon"
  };

  return map[n] || n;
}

function getVerse(bookName, chapterNum, verseNum) {
  if (!Array.isArray(bible) || bible.length === 0) return "[Bible not loaded]";

  const target = normalizeBookName(bookName);

  const book = bible.find(b =>
    normalizeBookName(b.name) === target ||
    normalizeBookName(b.commonName) === target
  );
  if (!book) return `[Book not found: ${bookName}]`;

  const chapters = Array.isArray(book.chapters) ? book.chapters : [];

  // supports either {chapter:{number,content}} or {number,content}
  const chapterObj = chapters.find(c =>
    Number(c?.chapter?.number ?? c?.number) === Number(chapterNum)
  );
  if (!chapterObj) return `[Chapter not found: ${bookName} ${chapterNum}]`;

  const verseList = chapterObj?.chapter?.content ?? chapterObj?.content;
  if (!Array.isArray(verseList)) return "[Chapter content missing]";

  const verse = verseList.find(v => Number(v?.number) === Number(verseNum));
  if (!verse) return `[Verse not found: ${bookName} ${chapterNum}:${verseNum}]`;

  const parts = Array.isArray(verse.content) ? verse.content : [verse.content];

  // Pull text from strings OR common object shapes
  const text = parts.map(p => {
    if (typeof p === "string") return p;
    if (p && typeof p === "object") {
      // common possibilities in Bible JSONs
      if (typeof p.text === "string") return p.text;
      if (typeof p.content === "string") return p.content;
      if (Array.isArray(p.content)) return p.content.filter(x => typeof x === "string").join("");
    }
    return "";
  }).join("");

  return text.trim();
}
// Build a section with dropdowns and table
function buildSection(section, index) {
  const mainSelect = section.querySelector(".mainTopicSelect");
  const subSelect = section.querySelector(".subTopicSelect");
  const bookSelect = section.querySelector(".bookSelect");
  const verseDiv = section.querySelector(".verseText");

  let rows = [];

  fetch(csvFiles[index])
    .then(r => r.text())
    .then(csv => {
    rows = Papa.parse(csv, { header: true, skipEmptyLines: true }).data
  .filter(r => r.MainTopic && r.SubTopic && r.Book && r.Chapter && r.Verse);

      // Populate main topics
      const mainTopics = [...new Set(rows.map(r => r.MainTopic))];
      mainTopics.forEach(t => {
        const opt = document.createElement("option");
        opt.value = t;
        opt.text = t;
        mainSelect.appendChild(opt);
      });
    });

  mainSelect.addEventListener("change", () => {
    subSelect.innerHTML = '<option value="">Select Sub-Topic</option>';
    bookSelect.innerHTML = '<option value="">Select Book</option>';
    verseDiv.innerHTML = "";

    const subs = [...new Set(
      rows.filter(r => r.MainTopic === mainSelect.value).map(r => r.SubTopic)
    )];

    subs.forEach(s => {
      const opt = document.createElement("option");
      opt.value = s;
      opt.text = s;
      subSelect.appendChild(opt);
    });
  });

  subSelect.addEventListener("change", () => {
    bookSelect.innerHTML = '<option value="">Select Book</option>';
    verseDiv.innerHTML = "";

    const books = [...new Set(
      rows.filter(r => r.MainTopic === mainSelect.value && r.SubTopic === subSelect.value)
          .map(r => r.Book)
    )];

    books.forEach(b => {
      const opt = document.createElement("option");
      opt.value = b;
      opt.text = b;
      bookSelect.appendChild(opt);
    });
  });

  bookSelect.addEventListener("change", async () => {
    verseDiv.innerHTML = "";

    if (!bible || bible.length === 0) {
      await loadBible(versionSelect.value);
    }

    const filtered = rows.filter(r =>
      r.MainTopic === mainSelect.value &&
      r.SubTopic === subSelect.value &&
      r.Book === bookSelect.value
    );

    const table = document.createElement("table");
    table.className = "verse-table";

    let currentChapter = null;

    filtered.forEach(row => {
      const chapterNum = parseInt(row.Chapter);
      if (chapterNum !== currentChapter) {
        // Add a spacer row for readability
        const spacer = document.createElement("tr");
        spacer.className = "spacer-row";
        const tdSpacer = document.createElement("td");
        tdSpacer.colSpan = 2;
        spacer.appendChild(tdSpacer);
        table.appendChild(spacer);

        // Add chapter row with gradient
        const trChapter = document.createElement("tr");
        trChapter.className = "chapter-row";
        const tdChapter = document.createElement("td");
        tdChapter.colSpan = 2;
        tdChapter.textContent = `Chapter ${chapterNum}`;
        trChapter.appendChild(tdChapter);
        table.appendChild(trChapter);

        currentChapter = chapterNum;
      }

      // Add verse row
      const trVerse = document.createElement("tr");
      trVerse.className = "verse-row";

      const tdNum = document.createElement("td");
      tdNum.className = "verse-number";
      tdNum.textContent = row.Verse;

      const tdText = document.createElement("td");
      tdText.textContent = getVerse(row.Book, chapterNum, parseInt(row.Verse));

      trVerse.appendChild(tdNum);
      trVerse.appendChild(tdText);

      table.appendChild(trVerse);
    });

    verseDiv.appendChild(table);
  });
}

// Build all sections
sections.forEach((section, index) => buildSection(section, index));

// Reload verses when Bible version changes
versionSelect.addEventListener("change", async () => {
  await loadBible(versionSelect.value);

  sections.forEach(section => {
    const bookSelect = section.querySelector(".bookSelect");
    if (bookSelect.value) {
      bookSelect.dispatchEvent(new Event('change'));
    }
  });
});

// Initial load
loadBible("WEB");
(async () => {
  await loadBible("WEB");
  console.log("WEB Judges 1:1", getVerse("Judges", 1, 1));
  console.log("WEB Proverbs 1:1", getVerse("Proverbs", 1, 1));

  await loadBible("KJV");
  console.log("KJV Judges 1:1", getVerse("Judges", 1, 1));
  console.log("KJV Proverbs 1:1", getVerse("Proverbs", 1, 1));
})();
</script>


<footer class="site-footer">

<a href="index.html">Home</a>
<a href="life_link.html">Life Link</a>
<a href="bible_journaling.html">Bible Journaling</a>
<a href="wordoku.html">WORDokus</a>
<a href="mazes.html">Mazes</a>
<a href="coloring_pages.html">Coloring Pages</a>
<a href="bible_reading_plans.html">Bible Reading Plans</a>
<a href="about.html">About</a>
<a href="#top">Top</a>

</footer>

</body>
</html>
